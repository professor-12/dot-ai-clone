---
import CustomButton from "./CustomButton.astro";
import Logo from "./Logo.astro";
import CaretDown from "./UI/CaretDown.astro";
---

<script>
    const LinksEl = document.querySelectorAll(".links");

    const LinkComponent = ({
        title,
        body,
        link,
    }: {
        title: string;
        body: string;
        link: string;
    }) => {
        return ` <a  href="${link}" class="p-3 px-5 h-16 flex items-center hover:bg-blue-300/10 rounded-lg">
                    <div class="flex text-sm">
                        <div class="flex flex-col">
                            <h1>${title}</h1>
                                <p class="text-slate-400 text-xs font-light">
                                    ${body}
                                </p>
                        </div>
                    </div>
                </a>`;
    };
    let currentActive: "banking" | "payment" | "insurance" = "banking";
    let data = {
        banking: [
            {
                title: "Corporate Banking",
                body: "Manage your business",
                link: "https://www.dot.ai/corporate-banking",
            },
            {
                title: "Investments",
                body: "Grow your wealth",
                link: "https://www.dot.ai/investments",
            },
            {
                title: "Loans",
                body: "Quick loan for business",
                link: "https://www.dot.ai/loans",
            },
        ],
        payment: [
            {
                title: "Dot Collect",
                body: "POS for your business",
                link: "https://www.dot.ai/collect",
            },
        ],
        insurance: [
            {
                title: "Corporate HMO",
                body: "Affordable insurance for your employees",
                link: "https://www.dot.ai/corporate-hmo",
            },
            {
                title: "Micro Insurance",
                body: "Secure your tommorow today",
                link: "https://www.dot.ai/micro-insurance",
            },
        ],
    };

    const handleActiveState = () => {
        LinksEl.forEach((el) => {
            if (el.textContent?.toLowerCase() == currentActive) {
                el.classList.add("bg-white");
            } else {
                el.classList.remove("bg-white");
            }
        });
    };
    handleActiveState();
    const element = document.querySelector("#drop-down-business");
    if (element) {
        data[currentActive].forEach((e) => {
            element.innerHTML += LinkComponent(e);
        });
    }
    LinksEl.forEach((el) => {
        el.addEventListener("mouseenter", (e) => {
            handleActiveState();
            const data_link = el.getAttribute("data-id");
            if (element) {
                element.innerHTML = "";
            }
            currentActive = data_link as "banking" | "payment" | "insurance";
            data[currentActive].forEach((e) => {
                if (element) {
                    element.innerHTML += LinkComponent(e);
                }
            });
        });
    });
</script>
<header
    class="flex py-[22px] max-lg:hidden bg-black font-inter fixed font-medium text-white top-0 z-[40] w-full"
>
    <div class="flex justify-between items-center contain">
        <div class="flex items-center">
            <Logo />
            <nav class="ml-[2.5rem] flex justify-center items-center">
                <ul class="flex w-full">
                    <li class="flex group relative gap-[.1rem] items-center">
                        <span>Business</span>
                        <CaretDown />
                        <div
                            class="absolute pop-in-animation transition-all hidden group-hover:flex pt-3 top-full"
                        >
                            <div
                                class="transition-all min-w-full max-w-full bg-white rounded-xl flex"
                            >
                                <div
                                    class="bg-green-200/20 rounded-l-xl flex flex-col p-4 py-5 pb-12 min-w-[13rem]"
                                >
                                    <div
                                        data-id="banking"
                                        class="links group/s"
                                    >
                                        <span>Banking</span>
                                        <span
                                            class="-rotate-90 group-hover/s:flex hidden"
                                            ><CaretDown /></span
                                        >
                                    </div>
                                    <div
                                        data-id="payment"
                                        class="links group/s"
                                    >
                                        <span>Payment</span>
                                        <span
                                            class="-rotate-90 group-hover/s:flex hidden"
                                            ><CaretDown /></span
                                        >
                                    </div>
                                    <div
                                        data-id="insurance"
                                        class="links group/s"
                                    >
                                        <span>Insurance</span>
                                        <span
                                            class="-rotate-90 group-hover/s:flex hidden"
                                            ><CaretDown /></span
                                        >
                                    </div>
                                </div>
                                <div
                                    class="min-w-[590px] shrink-0 p-5 gap-6 gap-y-3 grid grid-cols-2"
                                    id="drop-down-business"
                                >
                                </div>
                            </div>
                        </div>
                    </li>
                    <li class="flex gap-[.1rem] items-center">
                        <span>Personal</span>
                        <CaretDown />
                    </li>
                </ul>
            </nav>
            <nav class="flex justify-center items-center">
                <ul class="flex w-full">
                    <li class="flex gap-[.1rem] items-center">
                        <span class="">Agents</span>
                        <CaretDown />
                    </li>
                    <li class="flex gap-[.1rem] items-center">
                        <span>Why Dots?</span>
                        <CaretDown />
                    </li>
                </ul>
            </nav>
            <a href="" class="px-[8px] py-[6px] lg:px-[16px];">
                <div>Developers</div>
            </a>
        </div>

        <div class="flex items-center font-semibold md:space-x-6 space-x-4">
            <div class="flex gap-[.1rem] items-center">
                <span>Resources</span>
                <CaretDown />
            </div>
            <div class="flex items-center gap-[.1rem]">
                <span>Login</span>
                <svg
                    width="16"
                    height="17"
                    viewBox="0 0 16 17"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                    class="transition-all group-hover:translate-x-1"
                    ><g id="Outline / Arrows / Arrow Right"
                        ><path
                            id="Vector (Stroke)"
                            fill-rule="evenodd"
                            clip-rule="evenodd"
                            d="M8.98108 4.14645C9.17634 3.95118 9.49293 3.95118 9.68819 4.14645L13.6882 8.14645C13.8835 8.34171 13.8835 8.65829 13.6882 8.85355L9.68819 12.8536C9.49293 13.0488 9.17634 13.0488 8.98108 12.8536C8.78582 12.6583 8.78582 12.3417 8.98108 12.1464L12.1275 9H2.66797C2.39183 9 2.16797 8.77614 2.16797 8.5C2.16797 8.22386 2.39183 8 2.66797 8H12.1275L8.98108 4.85355C8.78582 4.65829 8.78582 4.34171 8.98108 4.14645Z"
                            fill="currentColor"></path></g
                    ></svg
                >
            </div>
            <CustomButton id="header_open_an_account" text="Open an account" />
        </div>
    </div>
</header>

<style>
    header {
        transition: all 0.5s cubic-bezier(0.215, 0.61, 0.355, 1);
    }
    span,
    div {
        @apply max-xl:text-[14px];
    }
    ul {
        @apply max-xl:gap-4;
    }
    .header-up {
        transform: translateY(-100%);
        background: transparent;
    }
    .bg-white {
        background: white;
        color: black;
        box-shadow: 0 0 1px 0px black;
    }

    li {
        @apply px-[8px] py-[6px] lg:px-[16px] hover:text-black hover:bg-white rounded-[0.5rem] cursor-pointer;
    }

    .pop-in-animation {
        animation: enterAnimation 0.13s ease-in;
    }

    @keyframes enterAnimation {
        0% {
            opacity: 0;
            scale: 0.6;
        }

        100% {
            opacity: 1;
            scale: 1;
        }
    }

    .links {
        @apply hover:bg-white py-4 px-3 flex items-center justify-between rounded-xl font-normal text-black hover:shadow-sm;
    }
</style>
